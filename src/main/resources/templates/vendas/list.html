<!DOCTYPE html>
<html th:replace="~{/fragments/layout :: layout(~{::head},~{::main})}">


<head th:replace="fragments/head.html :: head('Vendas')"></head>

<body>

<main>
    <div class="container my-2">

        <div th:if="${erroQtd != null}" class="d-flex justify-content-center align-items-center" >
            <span class="alert alert-danger mb-0" th:text="${erroQtd}"></span>
        </div>

        <form th:action="@{/vendas/pesquisarvenda}" method="get" style="margin-bottom: 20px;">
            <label for="data">Pesquisar venda:</label>
            <input name="data" id="data" type="date" class="mt-2" style="min-height: 30px;">
            <button type="submit" class="btn btn-secondary mt-2">Buscar</button>
        </form>


        <table border="1" class="table table-striped table-responsive-md">
            <thead>
            <tr>
                <th>Id</th>
                <th>Data</th>
                <th>Total</th>
                <th>Cliente</th>
                <th>Detalhes</th>
            </tr>
            <h1 style="text-align:center">Vendas</h1>
            </thead>
            <tbody>
            <tr th:each="v : ${vendas}">
                <td th:text="${v.id}"></td>
                <td th:text="${#temporals.format(v.data, 'dd/MM/yyyy')}"></td>
                <td th:text="${#numbers.formatCurrency(v.total())}"></td>
                <td th:text="${v.pessoa.nome}"></td>
                <td>
                    <button type="button" class="btn btn-secondary" data-toggle="collapse" th:data-target="'#detalhes-' + ${v.id}">Detalhes</button>
                    <div class="collapse" th:id="'detalhes-' + ${v.id}">
                        <table>
                            <tbody>
                            <tr th:each="i : ${v.itemVendas}">
                                <td th:text="${i.produto.descricao}"></td>
                                <td th:text="${i.quantidade}"></td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </td>
            </tr>
            </tbody>
        </table>


        <a th:href="@{/home}" class="btn btn-info">Voltar</a>
    </div>
</main>

</body>
</html>